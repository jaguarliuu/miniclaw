spring:
  application:
    name: miniclaw

  datasource:
    url: jdbc:postgresql://localhost:5432/miniclaw
    username: miniclaw
    password: miniclaw
    driver-class-name: org.postgresql.Driver
    hikari:
      minimum-idle: 5
      maximum-pool-size: 10
      auto-commit: true
      connection-timeout: 30000

  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: true
    properties:
      hibernate:
        format_sql: true
        dialect: org.hibernate.dialect.PostgreSQLDialect

  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true

server:
  port: 8080

# LLM 配置
llm:
  # 使用 OpenAI 兼容接口（可替换为 DeepSeek、通义千问、Ollama、GLM 等）
  # 路径自动处理：若不以 /v* 结尾，自动追加 /v1
  # Ollama: http://localhost:11434
  # DeepSeek: https://api.deepseek.com
  # 通义千问: https://dashscope.aliyuncs.com/compatible-mode
  # GLM (智谱): https://open.bigmodel.cn/api/paas/v4  (已含 /v4，不会再追加)
  endpoint: ${LLM_ENDPOINT}
  api-key: ${LLM_API_KEY}
  model: ${LLM_MODEL}
  temperature: 0.7
  max-tokens: 8192
  timeout: 120

# Agent 配置
agent:
  system-prompt: |
    你是一个有帮助的 AI 助手。请用中文回答用户的问题。
    回答要简洁、准确、有条理。
  max-history-messages: 20
  loop:
    max-steps: 50
    run-timeout-seconds: 300
    step-timeout-seconds: 120
  hitl:
    timeout-seconds: 300  # HITL 确认超时时间（5分钟）

# Tools 配置
tools:
  workspace: ${TOOLS_WORKSPACE:./workspace}
  max-file-size: 1048576  # 1MB
skills:
  watch-enabled: true  # 是否启用热更新
  index-token-budget: 2000  # 索引 token 预算