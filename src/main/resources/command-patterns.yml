# Remote Command Classification Patterns
# 定义命令安全级别的正则表达式模式

# Level 2: DESTRUCTIVE (永远禁止)
destructive:
  - pattern: '\\brm\s+(-[a-zA-Z]*r[a-zA-Z]*f|--recursive).*(\/|\*)'
    description: 'Recursive rm with wildcard or root'
  - pattern: '\\brm\s+-rf\\b'
    description: 'rm -rf command'
  - pattern: '\\b(shutdown|reboot|halt|poweroff)\\b'
    description: 'System shutdown commands'
  - pattern: '\\bmkfs\\b'
    description: 'Filesystem format'
  - pattern: '\\bdd\s+.*of\s*=\s*/dev/'
    description: 'Direct disk write'
  - pattern: '\\bkubectl\s+delete\\b'
    description: 'Kubernetes delete'
  - pattern: '\\bkubectl\s+drain\\b'
    description: 'Kubernetes drain'
  - pattern: '\\bkubectl\s+cordon\\b'
    description: 'Kubernetes cordon'
  - pattern: '\\bDROP\s+(TABLE|DATABASE)\\b'
    description: 'SQL DROP statement'
  - pattern: '\\bTRUNCATE\s+TABLE\\b'
    description: 'SQL TRUNCATE'
  - pattern: '\\bDELETE\s+FROM\s+\w+\s*;'
    description: 'SQL DELETE without WHERE'
  - pattern: 'curl\s+[^|]+\|\s*(sh|bash)'
    description: 'Piped execution from curl'
  - pattern: 'wget\s+[^|]+\|\s*(sh|bash)'
    description: 'Piped execution from wget'
  - pattern: '\\biptables\s+-F\\b'
    description: 'Flush iptables rules'

# Level 0: READ_ONLY (安全只读)
read_only:
  - pattern: '^\\s*(df|free|top|ps|uptime|uname|hostname|whoami|id|w|last|who)\\b'
    description: 'System information commands'
  - pattern: '^\\s*(cat|ls|grep|tail|head|less|more|wc|find|file|stat)\\b'
    description: 'File reading commands'
  - pattern: '^\\s*(systemctl\s+status|journalctl|dmesg)\\b'
    description: 'System status commands'
  - pattern: '^\\s*(mount|lsblk|lscpu|lsmem|lspci|lsusb)\\b'
    description: 'Hardware listing commands'
  - pattern: '^\\s*(ip\s+(addr|route|link)|ifconfig|netstat|ss)\\b'
    description: 'Network info commands'
  - pattern: '^\\s*kubectl\s+(get|describe|logs|top)\\b'
    description: 'Kubernetes read-only commands'
  - pattern: '^\\s*kubectl\s+(cluster-info|version)\\b'
    description: 'Kubernetes cluster info'
  - pattern: '^\\s*(docker|podman)\s+(ps|images|logs|inspect|stats|info|version)\\b'
    description: 'Container read-only commands'
  - pattern: '^\\s*(ping|traceroute|tracepath|dig|nslookup|host|curl\s+-s?I)\\b'
    description: 'Network diagnostic commands'
  - pattern: '^\\s*SELECT\\b'
    description: 'SQL SELECT query'
  - pattern: '^\\s*SHOW\\b'
    description: 'SQL SHOW command'
  - pattern: '^\\s*DESCRIBE\\b'
    description: 'SQL DESCRIBE command'
  - pattern: '^\\s*EXPLAIN\\b'
    description: 'SQL EXPLAIN command'
